var w={Action:"action",Config:"config",Consent:"consent",Context:"context",Destination:"destination",Elb:"elb",Globals:"globals",Hook:"hook",Init:"init",Link:"link",Prefix:"data-elb",Run:"run",User:"user",Walker:"walker"},R={Cookie:"cookie",Local:"local",Session:"session"},O={Storage:R},b={Commands:w,Utils:O};function h(e,r={}){return Object.entries(r).forEach(([t,n])=>{let o=e[t];Array.isArray(o)&&Array.isArray(n)&&(r[t]=n.reduce((i,s)=>i.includes(s)?i:[...i,s],[...o]))}),{...e,...r}}function T(e){if(e==="true")return!0;if(e==="false")return!1;let r=Number(e);return e==r&&e!==""?r:String(e)}function C(e,r,t=0){return r.split(".").reduce((o,i)=>{if(i=="*"&&(i=String(t)),o instanceof Object)return o[i]},e)}function W(e=6){for(var r="",t=36;r.length<e;)r+=(Math.random()*t|0).toString(t);return r}function v(e,r={}){let t={},n=Object.assign({utm_campaign:"campaign",utm_content:"content",dclid:"clickId",fbclid:"clickId",gclid:"clickId",utm_medium:"medium",msclkid:"clickId",utm_source:"source",utm_term:"term"},r);return Object.entries(n).forEach(([o,i])=>{let s=e.searchParams.get(o);s&&(t[i]=s)}),t}function H(e,r=1e3){let t;return(...n)=>(clearTimeout(t),new Promise(o=>{t=setTimeout(()=>{o(e(...n))},r)}))}function A(e,r=1e3){let t=null;return function(...n){if(t===null)return t=setTimeout(()=>{t=null},r),e(...n)}}function c(e,r){return typeof e==typeof r}function E(e,r=!1){r&&console.dir(e,{depth:4})}function a(e){throw new Error(String(e))}function L(e){return e?e.trim().replace(/^'|'$/g,"").trim():""}function k(e,r){return function(...t){try{return e(...t)}catch(n){return r?r(n):void 0}}}function j(e,r){return async function(...t){try{return await e(...t)}catch(n){return r?await r(n):void 0}}}function I(e,r,t){return function(...n){let o,i="pre"+r,s="post"+r,f=t[i],l=t[s];return f?o=f({fn:e},...n):o=e(...n),l&&(o=l({fn:e,result:o},...n)),o}}function U(e,r=[]){c(e,{})||a("Invalid object");let t,n,o;c(e.event,"")?(t=e.event,[n,o]=t.split(" "),(!n||!o)&&a("Invalid event name")):c(e.entity,"")&&c(e.action,"")?(n=e.entity,o=e.action,t=`${n} ${o}`):a("Missing or invalid event, entity, or action");let i={"*":{"*":{event:{maxLength:255},user:{allowedKeys:["id","device","session"]},consent:{allowedValues:[!0,!1]},timestamp:{min:0},timing:{min:0},count:{min:0},version:{allowedKeys:["client","tagging"]},source:{allowedKeys:["type","id","previous_id"]}}}},s={event:t,data:{},context:{},custom:{},globals:{},user:{},nested:[],consent:{},id:"",trigger:"",entity:n,action:o,timestamp:0,timing:0,group:"",count:0,version:{client:"",tagging:0},source:{type:"",id:"",previous_id:""}};return[i].concat(r).reduce((m,g)=>["*",n].reduce((S,d)=>["*",o].reduce((u,y)=>{var x;let p=(x=g[d])==null?void 0:x[y];return p?u.concat([p]):u},S),m),[]).reduce((m,g)=>{let S=Object.keys(g).filter(d=>{let u=g[d];return(u==null?void 0:u.required)===!0});return[...Object.keys(e),...S].reduce((d,u)=>{let y=g[u],p=e[u];return y&&(p=k(P,x=>{a(String(x))})(d,u,p,y)),c(p,d[u])&&(d[u]=p),d},m)},s)}function P(e,r,t,n){if(n.validate&&(t=k(n.validate,o=>{a(String(o))})(t,r,e)),n.required&&t===void 0&&a("Missing required property"),c(t,""))n.maxLength&&t.length>n.maxLength&&(n.strict&&a("Value exceeds maxLength"),t=t.substring(0,n.maxLength));else if(c(t,1))c(n.min,1)&&t<n.min?(n.strict&&a("Value below min"),t=n.min):c(n.max,1)&&t>n.max&&(n.strict&&a("Value exceeds max"),t=n.max);else if(c(t,{})){if(n.schema){let o=n.schema;Object.keys(o).reduce((i,s)=>{let f=o[s],l=i[s];return f&&(f.type&&typeof l!==f.type&&a(`Type doesn't match (${s})`),l=k(P,m=>{a(String(m))})(i,s,l,f)),l},t)}for(let[o,i]of Object.entries(t))n.allowedKeys&&!n.allowedKeys.includes(o)&&(n.strict&&a("Key not allowed"),delete t[o])}return t}export{b as Const,h as assign,T as castValue,H as debounce,C as getByStringDot,W as getId,v as getMarketingParameters,c as isSameType,E as onLog,A as throttle,a as throwError,L as trim,k as tryCatch,j as tryCatchAsync,I as useHooks,U as validateEvent,P as validateProperty};
