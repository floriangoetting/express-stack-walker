"use strict";var w=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var K=Object.prototype.hasOwnProperty;var F=(e,r)=>{for(var t in r)w(e,t,{get:r[t],enumerable:!0})},V=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of U(r))!K.call(e,o)&&o!==t&&w(e,o,{get:()=>r[o],enumerable:!(n=I(r,o))||n.enumerable});return e};var _=e=>V(w({},"__esModule",{value:!0}),e);var B={};F(B,{Const:()=>R,assign:()=>O,castValue:()=>b,debounce:()=>W,getByStringDot:()=>h,getId:()=>T,getMarketingParameters:()=>C,isSameType:()=>u,onLog:()=>H,throttle:()=>v,throwError:()=>s,trim:()=>A,tryCatch:()=>m,tryCatchAsync:()=>E,useHooks:()=>L,validateEvent:()=>j,validateProperty:()=>S});module.exports=_(B);var M={Action:"action",Config:"config",Consent:"consent",Context:"context",Destination:"destination",Elb:"elb",Globals:"globals",Hook:"hook",Init:"init",Link:"link",Prefix:"data-elb",Run:"run",User:"user",Walker:"walker"},q={Cookie:"cookie",Local:"local",Session:"session"},$={Storage:q},R={Commands:M,Utils:$};function O(e,r={}){return Object.entries(r).forEach(([t,n])=>{let o=e[t];Array.isArray(o)&&Array.isArray(n)&&(r[t]=n.reduce((i,a)=>i.includes(a)?i:[...i,a],[...o]))}),{...e,...r}}function b(e){if(e==="true")return!0;if(e==="false")return!1;let r=Number(e);return e==r&&e!==""?r:String(e)}function h(e,r,t=0){return r.split(".").reduce((o,i)=>{if(i=="*"&&(i=String(t)),o instanceof Object)return o[i]},e)}function T(e=6){for(var r="",t=36;r.length<e;)r+=(Math.random()*t|0).toString(t);return r}function C(e,r={}){let t={},n=Object.assign({utm_campaign:"campaign",utm_content:"content",dclid:"clickId",fbclid:"clickId",gclid:"clickId",utm_medium:"medium",msclkid:"clickId",utm_source:"source",utm_term:"term"},r);return Object.entries(n).forEach(([o,i])=>{let a=e.searchParams.get(o);a&&(t[i]=a)}),t}function W(e,r=1e3){let t;return(...n)=>(clearTimeout(t),new Promise(o=>{t=setTimeout(()=>{o(e(...n))},r)}))}function v(e,r=1e3){let t=null;return function(...n){if(t===null)return t=setTimeout(()=>{t=null},r),e(...n)}}function u(e,r){return typeof e==typeof r}function H(e,r=!1){r&&console.dir(e,{depth:4})}function s(e){throw new Error(String(e))}function A(e){return e?e.trim().replace(/^'|'$/g,"").trim():""}function m(e,r){return function(...t){try{return e(...t)}catch(n){return r?r(n):void 0}}}function E(e,r){return async function(...t){try{return await e(...t)}catch(n){return r?await r(n):void 0}}}function L(e,r,t){return function(...n){let o,i="pre"+r,a="post"+r,f=t[i],l=t[a];return f?o=f({fn:e},...n):o=e(...n),l&&(o=l({fn:e,result:o},...n)),o}}function j(e,r=[]){u(e,{})||s("Invalid object");let t,n,o;u(e.event,"")?(t=e.event,[n,o]=t.split(" "),(!n||!o)&&s("Invalid event name")):u(e.entity,"")&&u(e.action,"")?(n=e.entity,o=e.action,t=`${n} ${o}`):s("Missing or invalid event, entity, or action");let i={"*":{"*":{event:{maxLength:255},user:{allowedKeys:["id","device","session"]},consent:{allowedValues:[!0,!1]},timestamp:{min:0},timing:{min:0},count:{min:0},version:{allowedKeys:["client","tagging"]},source:{allowedKeys:["type","id","previous_id"]}}}},a={event:t,data:{},context:{},custom:{},globals:{},user:{},nested:[],consent:{},id:"",trigger:"",entity:n,action:o,timestamp:0,timing:0,group:"",count:0,version:{client:"",tagging:0},source:{type:"",id:"",previous_id:""}};return[i].concat(r).reduce((g,k)=>["*",n].reduce((P,d)=>["*",o].reduce((c,y)=>{var x;let p=(x=k[d])==null?void 0:x[y];return p?c.concat([p]):c},P),g),[]).reduce((g,k)=>{let P=Object.keys(k).filter(d=>{let c=k[d];return(c==null?void 0:c.required)===!0});return[...Object.keys(e),...P].reduce((d,c)=>{let y=k[c],p=e[c];return y&&(p=m(S,x=>{s(String(x))})(d,c,p,y)),u(p,d[c])&&(d[c]=p),d},g)},a)}function S(e,r,t,n){if(n.validate&&(t=m(n.validate,o=>{s(String(o))})(t,r,e)),n.required&&t===void 0&&s("Missing required property"),u(t,""))n.maxLength&&t.length>n.maxLength&&(n.strict&&s("Value exceeds maxLength"),t=t.substring(0,n.maxLength));else if(u(t,1))u(n.min,1)&&t<n.min?(n.strict&&s("Value below min"),t=n.min):u(n.max,1)&&t>n.max&&(n.strict&&s("Value exceeds max"),t=n.max);else if(u(t,{})){if(n.schema){let o=n.schema;Object.keys(o).reduce((i,a)=>{let f=o[a],l=i[a];return f&&(f.type&&typeof l!==f.type&&s(`Type doesn't match (${a})`),l=m(S,g=>{s(String(g))})(i,a,l,f)),l},t)}for(let[o,i]of Object.entries(t))n.allowedKeys&&!n.allowedKeys.includes(o)&&(n.strict&&s("Key not allowed"),delete t[o])}return t}0&&(module.exports={Const,assign,castValue,debounce,getByStringDot,getId,getMarketingParameters,isSameType,onLog,throttle,throwError,trim,tryCatch,tryCatchAsync,useHooks,validateEvent,validateProperty});
